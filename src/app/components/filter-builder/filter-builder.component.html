<mat-sidenav-container #visualization class="visualization-sidenav" [class.neon-green-dark-theme]="themesService.getCurrentTheme().id === 'neon-green-dark-theme'">
    <mat-toolbar class="neon-toolbar-thin" color="header" layout-align="space-between center" flex>
        <div #headerText class="header text pull-left" [title]="meta.title">{{ meta.title }}</div>

        <span class="fill-remaining"></span>

        <button mat-icon-button aria-label="Add" matTooltip="Add New Clause" tooltip-position="below" (click)="addBlankWhereClause()">
            <mat-icon>add_circle</mat-icon>
        </button>

        <button mat-icon-button aria-label="Reset" matTooltip="Reset Filter Builder" tooltip-position="below"
                (click)="resetFilterBuilder()">
            <mat-icon>delete_sweep</mat-icon>
        </button>

        <mat-button-toggle-group #showColumnSelector="matButtonToggleGroup" [(ngModel)]="active.andor" (change)="handleChangeAndOr()"
                class="neon-button-toggle-group-small">
            <mat-button-toggle value="and">
                AND
            </mat-button-toggle>
            <mat-button-toggle value="or">
                OR
            </mat-button-toggle>
        </mat-button-toggle-group>
    </mat-toolbar>

    <div class="body-container">
        <div class="main-container">
            <div class="clause-container" *ngFor="let clause of active.clauses">
                <div class="clause-form-container">
                    <mat-form-field class="neon-form-field-flex-5 neon-form-field-large">
                        <mat-select placeholder="Database" [(ngModel)]="clause.changeDatabase"
                                    required="true" (ngModelChange)="handleChangeDatabaseOfClause(clause)"
                                    [disabled]="clause.databases.length < 2">
                            <mat-option *ngFor="let database of clause.databases" [value]="database">{{ database.prettyName }}</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field class="neon-form-field-flex-5 neon-form-field-large">
                        <mat-select placeholder="Table" [(ngModel)]="clause.changeTable"
                                    required="true" (ngModelChange)="handleChangeTableOfClause(clause)"
                                    [disabled]="clause.tables.length < 2">
                            <mat-option *ngFor="let table of clause.tables" [value]="table">{{ table.prettyName }}</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field class="neon-form-field-flex-5 neon-form-field-large">
                        <mat-select placeholder="Field" [(ngModel)]="clause.changeField"
                                    required="true" (ngModelChange)="handleChangeFieldOfClause(clause)"
                                    [disabled]="clause.fields.length == 0">
                            <mat-option *ngFor="let field of clause.fields" [value]="field">{{ field.prettyName }}</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field class="neon-form-field-flex-5 neon-form-field-large">
                        <mat-select placeholder="Operator" [(ngModel)]="clause.operator"
                                    required="true" (ngModelChange)="handleChangeDataOfClause(clause)"
                                    [disabled]="active.operators.length == 0">
                            <mat-option *ngFor="let operator of active.operators" [value]="operator">{{ operator.prettyName }}</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field class="neon-form-field-flex-5 neon-form-field-large">
                        <input matInput placeholder="Value" [(ngModel)]="clause.value" (input)="handleChangeDataOfClause(clause)">
                    </mat-form-field>
                </div>

                <div class="clause-button-container">
                    <button mat-icon-button class="neon-icon-button-large clause-button" (click)="activateClause(clause)"
                            [disabled]="!validateClause(clause)" matTooltip="Update Filter" tooltip-position="below" *ngIf="!clause.active">
                        <mat-icon class="neon-icon-large">refresh</mat-icon>
                    </button>

                    <button mat-icon-button class="neon-icon-button-large clause-button active" (click)="activateClause(clause)"
                            matTooltip="Filter is Active" tooltip-position="below" *ngIf="clause.active">
                        <mat-icon class="neon-icon-large">check_circle</mat-icon>
                    </button>

                    <button mat-icon-button class="neon-icon-button-large clause-button" (click)="removeClause(clause)"
                            matTooltip="Remove Filter" tooltip-position="below">
                        <mat-icon class="neon-icon-large">delete</mat-icon>
                    </button>
                </div>
            </div>
        </div>
    </div>
</mat-sidenav-container>
